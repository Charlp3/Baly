<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Suivi Chien - Pierre Charlier 2025</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #D0E4F7;
      color: #1C2A40;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #2C5E99;
      color: white;
      padding: 15px;
      text-align: center;
    }
    header small {
      display: block;
      font-size: 0.85rem;
      margin-top: 5px;
    }
    nav {
      display: flex;
      justify-content: space-around;
      background-color: #1C3B68;
      border-bottom: 2px solid #113059;
    }
    nav button {
      flex: 1;
      padding: 12px;
      background-color: #1C3B68;
      color: white;
      border: none;
      font-size: 1rem;
      cursor: pointer;
    }
    nav button.active {
      background-color: #D0E4F7;
      color: #1C3B68;
      font-weight: bold;
    }
    section {
      display: none;
      padding: 20px;
    }
    section.active {
      display: block;
    }
    .entry-group {
      border: 1px solid #bbb;
      padding: 10px;
      border-radius: 5px;
      margin-top: 10px;
      background-color: #EAF2FB;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #587EA3;
      background-color: #F0F8FF;
      font-size: 1rem;
    }
    label {
      margin-top: 10px;
      display: block;
      font-weight: bold;
    }
    button.action {
      background-color: #2C5E99;
      color: white;
      padding: 8px 12px;
      margin: 10px 4px 0 0;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
    }
    button.delete-btn {
      background-color: #c33;
      color: white;
      font-size: 0.9rem;
      margin-top: 6px;
      padding: 6px 10px;
      border-radius: 4px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #fff;
    }
    th, td {
      padding: 10px;
      border: 1px solid #587EA3;
      text-align: left;
    }
    th {
      background-color: #2C5E99;
      color: white;
    }
    tr:nth-child(even) {
      background-color: #f2f7fc;
    }
  </style>
</head>
<body>
  <header>
    Suivi de mon chien üêæ
    <small>¬© Pierre Charlier 2025 ‚Äî Version 1.8</small>
  </header>

  <nav>
    <button onclick="showTab('fiche')" class="active">Fiche</button>
    <button onclick="showTab('medicaments')">M√©dicaments</button>
    <button onclick="showTab('vaccins')">Vaccins / Antiparasites</button>
    <button onclick="showTab('notices')">Notices</button>
    <button onclick="showTab('passeport')">Passeport PDF</button>
  </nav>

  <main>
    <section id="fiche" class="active"><label for="chipId">N¬∫ de puce</label>
      <input type="text" id="chipId">

      <label for="passportId">N¬∫ de passeport</label>
      <input type="text" id="passportId">

      <label for="birthDate">Date de naissance</label>
      <input type="date" id="birthDate" onchange="updateAge()">
      <div><strong>√Çge :</strong> <span id="dogAge">-</span></div>

      <label for="weight">Poids (kg)</label>
      <input type="number" id="weight" step="0.1">

      <label for="veto">V√©t√©rinaire / Confr√®res</label>
      <input type="text" id="veto">

      <label for="tel">T√©l√©phone</label>
      <input type="tel" id="tel">

      <label for="clinic">Clinique / Cabinet</label>
      <input type="text" id="clinic">

      <label for="nourriture">Nourriture</label>
      <textarea id="nourriture" rows="2"></textarea>

      <label for="accessoires">Accessoires</label>
      <textarea id="accessoires" rows="2"></textarea>

      <label for="autres">Autres</label>
      <textarea id="autres" rows="2"></textarea>

      <button class="action" onclick="saveData()">üíæ Sauvegarder</button>
    </section><section id="medicaments">
      <h2>M√©dicaments</h2>
      <div id="medicamentsList"></div>
      <button class="action" onclick="addMedicament()">+ Ajouter un m√©dicament</button>
    </section>
    <section id="vaccins">
      <h2>Vaccins & Antiparasitaires</h2>
      <div id="vaccinsList"></div>
      <button class="action" onclick="addVaccin()">+ Ajouter un vaccin ou antiparasitaire</button>
    </section>

    <section id="notices">
      <h2>Notices enregistr√©es</h2>
      <ul id="noticesList"></ul>
    </section>

    <section id="passeport">
      <h2>Pages du passeport PDF</h2>
      <input type="file" id="pdfInput" accept="application/pdf">
      <button class="action" onclick="addPDF()">+ Ajouter un PDF</button>
      <ul id="pdfList"></ul>
    </section>
  </main>

  <script>
    function showTab(tabId) {
      document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
      document.querySelector("button[onclick="showTab('" + tabId + "')"]").classList.add("active");
      document.getElementById(tabId).classList.add("active");
    }

    function updateAge() {
      const birth = document.getElementById("birthDate").value;
      const ageSpan = document.getElementById("dogAge");
      if (!birth) return ageSpan.textContent = "-";
      const b = new Date(birth);
      const today = new Date();
      let age = today.getFullYear() - b.getFullYear();
      const m = today.getMonth() - b.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < b.getDate())) age--;
      ageSpan.textContent = age + " an" + (age > 1 ? "s" : "");
    }

    const medicaments = [];
    const vaccins = [];
    const notices = new Set();
    const pdfFiles = [];

    function saveData() {
      const data = {
        chipId: document.getElementById("chipId").value,
        passportId: document.getElementById("passportId").value,
        birthDate: document.getElementById("birthDate").value,
        weight: document.getElementById("weight").value,
        veto: document.getElementById("veto").value,
        tel: document.getElementById("tel").value,
        clinic: document.getElementById("clinic").value,
        nourriture: document.getElementById("nourriture").value,
        accessoires: document.getElementById("accessoires").value,
        autres: document.getElementById("autres").value,
        medicaments, vaccins, pdfFiles: pdfFiles.map(p => p.name)
      };
      localStorage.setItem("chienData", JSON.stringify(data));
      alert("‚úî Donn√©es sauvegard√©es");
    }

    function addMedicament() {
      const m = { nom: "", date: "", lien: "" };
      medicaments.push(m);
      const div = document.createElement("div");
      div.className = "entry-group";
      div.innerHTML = `
        <label>Nom</label><input onchange="m.nom=this.value" placeholder="Nom du m√©dicament">
        <label>Date</label><input type="date" onchange="m.date=this.value">
        <label>Lien notice</label><input onchange="m.lien=this.value; updateNotices()" placeholder="https://...">
      `;
      document.getElementById("medicamentsList").appendChild(div);
    }

    function addVaccin() {
      const v = { nom: "", date: "", lien: "" };
      vaccins.push(v);
      const div = document.createElement("div");
      div.className = "entry-group";
      div.innerHTML = `
        <label>Nom</label><input onchange="v.nom=this.value" placeholder="Nom du vaccin ou antiparasitaire">
        <label>Date</label><input type="date" onchange="v.date=this.value">
        <label>Lien notice</label><input onchange="v.lien=this.value; updateNotices()" placeholder="https://...">
      `;
      document.getElementById("vaccinsList").appendChild(div);
    }

    function updateNotices() {
      notices.clear();
      medicaments.forEach(m => m.lien && notices.add(m.lien));
      vaccins.forEach(v => v.lien && notices.add(v.lien));
      const ul = document.getElementById("noticesList");
      ul.innerHTML = "";
      notices.forEach(link => {
        const li = document.createElement("li");
        li.innerHTML = `<a href="${link}" target="_blank">${link}</a>`;
        ul.appendChild(li);
      });
    }

    function addPDF() {
      const input = document.getElementById("pdfInput");
      if (input.files.length > 0) {
        const file = input.files[0];
        pdfFiles.push(file);
        const li = document.createElement("li");
        li.textContent = file.name + " ";
        const removeBtn = document.createElement("button");
        removeBtn.textContent = "üóë";
        removeBtn.onclick = () => {
          const i = pdfFiles.indexOf(file);
          if (i > -1) pdfFiles.splice(i, 1);
          li.remove();
        };
        li.appendChild(removeBtn);
        document.getElementById("pdfList").appendChild(li);
      }
    }

    window.onload = () => {
      const saved = localStorage.getItem("chienData");
      if (saved) {
        const d = JSON.parse(saved);
        ["chipId","passportId","birthDate","weight","veto","tel","clinic","nourriture","accessoires","autres"].forEach(id => {
          if (d[id]) document.getElementById(id).value = d[id];
        });
        updateAge();
        (d.medicaments || []).forEach(() => addMedicament());
        (d.vaccins || []).forEach(() => addVaccin());
        (d.pdfFiles || []).forEach(name => {
          const li = document.createElement("li");
          li.textContent = name;
          document.getElementById("pdfList").appendChild(li);
        });
      }
    }
  </script>
</body>
</html>
