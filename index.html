<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Suivi Chien ‚Äì v1.7 (Liens)</title>
  <style>
    body { font-family: Arial; margin: 0; background: #D0E4F7; color: #1C2A40; }
    header { background: #2C5E99; color: #fff; text-align: center; padding: 15px; }
    nav { display: flex; background: #1C3B68; flex-wrap: wrap; }
    nav button {
      flex: 1 1 25%; padding: 12px; background: #1C3B68; color: white;
      border: none; font-size: 1rem; cursor: pointer;
    }
    nav button.active {
      background: #D0E4F7; color: #1C3B68; font-weight: bold;
    }
    section { display: none; padding: 20px; }
    section.active { display: block; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, textarea {
      width: 100%; padding: 8px; margin-top: 4px;
      border-radius: 4px; border: 1px solid #587EA3;
      background-color: #F0F8FF; font-size: 1rem;
    }
    button.action {
      margin-top: 15px;
      background-color: #2C5E99;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    Suivi de mon chien üêæ<br />
    <small>¬© Pierre Charlier 2025 ‚Äî Version 1.7 (Liens)</small>
  </header>

  <nav>
    <button onclick="showTab('fiche')" class="active">Fiche</button>
    <button onclick="showTab('medicaments')">M√©dicaments</button>
    <button onclick="showTab('vaccins')">Vaccins</button>
    <button onclick="showTab('notices')">Notices</button>
    <button onclick="showTab('pdf')">Passeport PDF</button>
    <button onclick="showTab('liens')">Liens Web</button>
  </nav>

  <main>
    <section id="fiche" class="active">
      <label for="puce">Num√©ro de puce</label>
      <input type="text" id="puce">
      <label for="passeport">Num√©ro de passeport</label>
      <input type="text" id="passeport">
      <label for="naissance">Date de naissance</label>
      <input type="date" id="naissance" onchange="updateAge()">
      <div><strong>√Çge :</strong> <span id="age">-</span></div>
      <label for="poids">Poids (kg)</label>
      <input type="number" id="poids">
      <label for="veto">V√©t√©rinaire</label>
      <input type="text" id="veto">
      <label for="tel">T√©l√©phone</label>
      <input type="tel" id="tel">
      <label for="clinique">Clinique</label>
      <input type="text" id="clinique">
      <label for="nourriture">Nourriture</label>
      <textarea id="nourriture"></textarea>
      <label for="accessoires">Accessoires</label>
      <textarea id="accessoires"></textarea>
      <label for="autres">Autres</label>
      <textarea id="autres"></textarea>
      <button class="action" onclick="saveData()">üíæ Sauvegarder</button>

<input type="file" id="importInput" accept="application/json"
       style="display:none" onchange="importData(event)">

<button class="action"
        onclick="document.getElementById('importInput').click()">
  üì• Importer
</button>
    </section>

    <section id="medicaments">
      <h3>M√©dicaments</h3>
      <div id="listeMeds"></div>
      <button class="action" onclick="ajouterMedicament()">+ Ajouter M√©dicament</button>
    </section>

    <section id="vaccins">
      <h3>Vaccins & Antiparasitaires</h3>
      <div id="listeVaccins"></div>
      <button class="action" onclick="ajouterVaccin()">+ Ajouter Vaccin</button>
    </section>

    <section id="notices">
      <h3>Notices</h3>
      <ul id="listeNotices"></ul>
    </section>

    <section id="pdf">
      <h3>Pages du Passeport PDF</h3>
      <input type="file" id="pdfInput" accept="application/pdf">
      <button class="action" onclick="ajouterPDF()">+ Ajouter PDF</button>
      <ul id="listePDF"></ul>
    </section>

    <section id="liens">
      <h3>Liens Internet</h3>
      <div id="listeLiens"></div>
      <button class="action" onclick="ajouterLien()">+ Ajouter lien</button>
    </section>
  </main>
<script>
  const donn√©es = { fiche: {}, meds: [], vaccins: [], pdfs: [], liens: [] };

  function showTab(id) {
    document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
    document.querySelectorAll("main section").forEach(s => s.classList.remove("active"));
    document.querySelector("button[onclick=\"showTab('" + id + "')\"]").classList.add("active");
    document.getElementById(id).classList.add("active");
  }

  function updateAge() {
    const n = document.getElementById("naissance").value;
    const span = document.getElementById("age");
    if (!n) return span.textContent = "-";
    const birth = new Date(n), now = new Date();
    let age = now.getFullYear() - birth.getFullYear();
    const m = now.getMonth() - birth.getMonth();
    if (m < 0 || (m === 0 && now.getDate() < birth.getDate())) age--;
    span.textContent = age + " an" + (age > 1 ? "s" : "");
  }

  function saveData() {
    donn√©es.fiche = {
      puce: puce.value, passeport: passeport.value, naissance: naissance.value,
      poids: poids.value, veto: veto.value, tel: tel.value,
      clinique: clinique.value, nourriture: nourriture.value,
      accessoires: accessoires.value, autres: autres.value
    };
    localStorage.setItem("chienData", JSON.stringify(donn√©es));
    alert("‚úî Donn√©es sauvegard√©es");
    majNotices();
  }

  function ajouterMedicament(nom="", date="", lien="") {
    const i = donn√©es.meds.push({ nom, date, lien }) - 1;
    const bloc = document.createElement("div");
    bloc.innerHTML = `
      <input placeholder="Nom" value="${nom}" onchange="donn√©es.meds[${i}].nom=this.value">
      <input type="date" value="${date}" onchange="donn√©es.meds[${i}].date=this.value">
      <input placeholder="Lien notice" value="${lien}" onchange="donn√©es.meds[${i}].lien=this.value; majNotices()"><hr>`;
    listeMeds.appendChild(bloc);
  }

  function ajouterVaccin(nom="", date="", lien="") {
    const i = donn√©es.vaccins.push({ nom, date, lien }) - 1;
    const bloc = document.createElement("div");
    bloc.innerHTML = `
      <input placeholder="Nom" value="${nom}" onchange="donn√©es.vaccins[${i}].nom=this.value">
      <input type="date" value="${date}" onchange="donn√©es.vaccins[${i}].date=this.value">
      <input placeholder="Lien notice" value="${lien}" onchange="donn√©es.vaccins[${i}].lien=this.value; majNotices()"><hr>`;
    listeVaccins.appendChild(bloc);
  }

  function majNotices() {
    const liens = [...donn√©es.meds, ...donn√©es.vaccins].map(e => e.lien).filter(Boolean);
    listeNotices.innerHTML = liens.map(l => `<li><a href="${l}" target="_blank">${l}</a></li>`).join("");
  }

  function ajouterPDF() {
    const f = pdfInput.files[0];
    if (f) {
      donn√©es.pdfs.push(f.name);
      const li = document.createElement("li");
      li.textContent = f.name;
      listePDF.appendChild(li);
    }
  }

  function ajouterLien(nom="", url="") {
    const i = donn√©es.liens.push({ nom, url }) - 1;
    const bloc = document.createElement("div");
    bloc.innerHTML = `
      <input placeholder="Nom" value="${nom}" onchange="donn√©es.liens[${i}].nom=this.value">
      <input placeholder="URL" value="${url}" onchange="donn√©es.liens[${i}].url=this.value">
      <hr>`;
    listeLiens.appendChild(bloc);
  }

  window.onload = () => {
    const sauvegarde = JSON.parse(localStorage.getItem("chienData") || "{}");
    if (!sauvegarde.fiche) return;
    Object.assign(donn√©es, sauvegarde);
    const f = donn√©es.fiche;
    puce.value = f.puce || ""; passeport.value = f.passeport || "";
    naissance.value = f.naissance || ""; poids.value = f.poids || "";
    veto.value = f.veto || ""; tel.value = f.tel || "";
    clinique.value = f.clinique || ""; nourriture.value = f.nourriture || "";
    accessoires.value = f.accessoires || ""; autres.value = f.autres || "";
    updateAge();
    donn√©es.meds.forEach(m => ajouterMedicament(m.nom, m.date, m.lien));
    donn√©es.vaccins.forEach(v => ajouterVaccin(v.nom, v.date, v.lien));
    donn√©es.pdfs.forEach(n => {
      const li = document.createElement("li");
      li.textContent = n;
      listePDF.appendChild(li);
    });
    donn√©es.liens.forEach(l => ajouterLien(l.nom, l.url));
    majNotices();
  }
function importData(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = e => {
    try {
      const imported = JSON.parse(e.target.result);

      if (!imported.fiche) {
        alert("‚ùå Fichier invalide");
        return;
      }

      localStorage.setItem("chienData", JSON.stringify(imported));
      alert("‚úî Importation r√©ussie\nLes donn√©es vont √™tre recharg√©es");
      location.reload();
    } catch {
      alert("‚ùå Erreur lors de l'importation");
    }
  };
  reader.readAsText(file);
}
</script>
</body>
</html>