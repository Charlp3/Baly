<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suivi Chien ‚Äì v1.8</title>
<style>
body { font-family: Arial; margin: 0; background: #D0E4F7; color: #1C2A40; }
header { background: #2C5E99; color: #fff; text-align: center; padding: 15px; }
nav { display: flex; background: #1C3B68; flex-wrap: wrap; }
nav button {
  flex: 1 1 25%; padding: 12px; background: #1C3B68; color: white;
  border: none; font-size: 1rem; cursor: pointer;
}
nav button.active { background: #D0E4F7; color: #1C3B68; font-weight: bold; }
section { display: none; padding: 20px; }
section.active { display: block; }
label { display: block; margin-top: 10px; font-weight: bold; }
input, textarea {
  width: 100%; padding: 8px; margin-top: 4px;
  border-radius: 4px; border: 1px solid #587EA3;
  background-color: #F0F8FF; font-size: 1rem;
}
button.action {
  margin-top: 15px;
  background-color: #2C5E99;
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  cursor: pointer;
}
hr { margin: 20px 0; }
</style>
</head>

<body>

<header>
Suivi de mon chien üêæ<br>
<small>¬© Pierre Charlier 2025 ‚Äî Version 1.8</small>
</header>

<nav>
<button onclick="showTab('fiche')" class="active">Fiche</button>
<button onclick="showTab('medicaments')">M√©dicaments</button>
<button onclick="showTab('vaccins')">Vaccins</button>
<button onclick="showTab('sante')">Sant√©</button>
<button onclick="showTab('pdf')">Passeport PDF</button>
<button onclick="showTab('liens')">Liens Web</button>
</nav>

<main>

<section id="fiche" class="active">
<label>Num√©ro de puce</label><input id="puce">
<label>Num√©ro de passeport</label><input id="passeport">
<label>Date de naissance</label><input type="date" id="naissance" onchange="updateAge()">
<div><strong>√Çge :</strong> <span id="age">-</span></div>
<label>Poids (kg)</label><input type="number" id="poids">
<label>V√©t√©rinaire</label><input id="veto">
<label>T√©l√©phone</label><input id="tel">
<label>Clinique</label><input id="clinique">
<label>Nourriture</label><textarea id="nourriture"></textarea>
<label>Accessoires</label><textarea id="accessoires"></textarea>
<label>Autres</label><textarea id="autres"></textarea>

<button class="action" onclick="saveData()">üíæ Sauvegarder</button>
<button class="action" onclick="exportData()">üì§ Exporter JSON</button>

<input type="file" id="importInput" accept="application/json" style="display:none" onchange="importData(event)">
<button class="action" onclick="importInput.click()">üì• Importer</button>
</section>

<section id="medicaments">
<h3>M√©dicaments</h3>
<div id="listeMeds"></div>
<button class="action" onclick="ajouterMedicament()">+ Ajouter</button>
</section>

<section id="vaccins">
<h3>Vaccins</h3>
<div id="listeVaccins"></div>
<button class="action" onclick="ajouterVaccin()">+ Ajouter</button>
</section>

<section id="sante">
<h3>Maladies</h3>
<div id="listeMaladies"></div>
<button class="action" onclick="ajouterMaladie()">+ Ajouter</button>
<hr>
<h3>Accidents</h3>
<div id="listeAccidents"></div>
<button class="action" onclick="ajouterAccident()">+ Ajouter</button>
<hr>
<h3>Traitements</h3>
<div id="listeTraitements"></div>
<button class="action" onclick="ajouterTraitement()">+ Ajouter</button>
</section>

<section id="pdf">
<h3>Passeport PDF</h3>
<input type="file" id="pdfInput" accept="application/pdf">
<button class="action" onclick="ajouterPDF()">+ Ajouter</button>
<ul id="listePDF"></ul>
</section>

<section id="liens">
<h3>Liens Internet</h3>
<div id="listeLiens"></div>
<button class="action" onclick="ajouterLien()">+ Ajouter</button>
</section>

</main>

<script>
const donn√©es = {
fiche:{}, meds:[], vaccins:[],
maladies:[], accidents:[], traitements:[],
pdfs:[], liens:[]
};

function showTab(id){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
document.getElementById(id).classList.add("active");
event.target.classList.add("active");
}

function updateAge(){
if(!naissance.value){age.textContent="-";return;}
const b=new Date(naissance.value), n=new Date();
let a=n.getFullYear()-b.getFullYear();
if(n.getMonth()<b.getMonth()||n.getMonth()==b.getMonth()&&n.getDate()<b.getDate())a--;
age.textContent=a+" an"+(a>1?"s":"");
}

function saveData(){
donn√©es.fiche={
puce:puce.value,passeport:passeport.value,naissance:naissance.value,
poids:poids.value,veto:veto.value,tel:tel.value,clinique:clinique.value,
nourriture:nourriture.value,accessoires:accessoires.value,autres:autres.value
};
localStorage.setItem("chienData",JSON.stringify(donn√©es));
alert("‚úî Donn√©es sauvegard√©es");
}

function exportData(){
const blob=new Blob([JSON.stringify(donn√©es,null,2)],{type:"application/json"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="chien_sauvegarde.json";
a.click();
URL.revokeObjectURL(a.href);
}

function importData(e){
const f=e.target.files[0]; if(!f)return;
const r=new FileReader();
r.onload=()=>{
try{
const j=JSON.parse(r.result);
const d={
fiche:j.fiche||{}, meds:j.meds||[], vaccins:j.vaccins||[],
maladies:j.maladies||[], accidents:j.accidents||[], traitements:j.traitements||[],
pdfs:j.pdfs||[], liens:j.liens||[]
};
localStorage.setItem("chienData",JSON.stringify(d));
location.reload();
}catch{alert("‚ùå Fichier invalide");}
};
r.readAsText(f);
}

/* Fonctions ajout */
function ajouterChamp(arr,obj,html,container){
const i=arr.push(obj)-1;
const d=document.createElement("div");
d.innerHTML=html(i);
container.appendChild(d);
}

function ajouterMedicament(n="",d="",l=""){
ajouterChamp(donn√©es.meds,{nom:n,date:d,lien:l},
i=>`<input value="${n}" placeholder="Nom" onchange="donn√©es.meds[${i}].nom=this.value">
<input type="date" value="${d}" onchange="donn√©es.meds[${i}].date=this.value">
<input value="${l}" placeholder="Lien" onchange="donn√©es.meds[${i}].lien=this.value"><hr>`,
listeMeds);
}

function ajouterVaccin(n="",d="",l=""){
ajouterChamp(donn√©es.vaccins,{nom:n,date:d,lien:l},
i=>`<input value="${n}" placeholder="Nom" onchange="donn√©es.vaccins[${i}].nom=this.value">
<input type="date" value="${d}" onchange="donn√©es.vaccins[${i}].date=this.value">
<input value="${l}" placeholder="Lien" onchange="donn√©es.vaccins[${i}].lien=this.value"><hr>`,
listeVaccins);
}

function ajouterMaladie(n="",d="",r=""){
ajouterChamp(donn√©es.maladies,{nom:n,date:d,remarque:r},
i=>`<input value="${n}" placeholder="Maladie" onchange="donn√©es.maladies[${i}].nom=this.value">
<input type="date" value="${d}" onchange="donn√©es.maladies[${i}].date=this.value">
<textarea onchange="donn√©es.maladies[${i}].remarque=this.value">${r}</textarea><hr>`,
listeMaladies);
}

function ajouterAccident(t="",d="",s=""){
ajouterChamp(donn√©es.accidents,{type:t,date:d,suite:s},
i=>`<input value="${t}" placeholder="Accident" onchange="donn√©es.accidents[${i}].type=this.value">
<input type="date" value="${d}" onchange="donn√©es.accidents[${i}].date=this.value">
<textarea onchange="donn√©es.accidents[${i}].suite=this.value">${s}</textarea><hr>`,
listeAccidents);
}

function ajouterTraitement(n="",db="",df="",p=""){
ajouterChamp(donn√©es.traitements,{nom:n,debut:db,fin:df,posologie:p},
i=>`<input value="${n}" placeholder="Traitement" onchange="donn√©es.traitements[${i}].nom=this.value">
<label>D√©but</label><input type="date" value="${db}" onchange="donn√©es.traitements[${i}].debut=this.value">
<label>Fin</label><input type="date" value="${df}" onchange="donn√©es.traitements[${i}].fin=this.value">
<textarea onchange="donn√©es.traitements[${i}].posologie=this.value">${p}</textarea><hr>`,
listeTraitements);
}

function ajouterPDF(){
if(pdfInput.files[0]){
donn√©es.pdfs.push(pdfInput.files[0].name);
listePDF.innerHTML+=`<li>${pdfInput.files[0].name}</li>`;
}
}

function ajouterLien(n="",u=""){
ajouterChamp(donn√©es.liens,{nom:n,url:u},
i=>`<input value="${n}" placeholder="Nom" onchange="donn√©es.liens[${i}].nom=this.value">
<input value="${u}" placeholder="URL" onchange="donn√©es.liens[${i}].url=this.value"><hr>`,
listeLiens);
}

window.onload=()=>{
const s=JSON.parse(localStorage.getItem("chienData")||"{}");
if(!s.fiche)return;
Object.assign(donn√©es,s);
Object.entries(donn√©es.fiche).forEach(([k,v])=>document.getElementById(k).value=v||"");
updateAge();
donn√©es.meds.forEach(m=>ajouterMedicament(m.nom,m.date,m.lien));
donn√©es.vaccins.forEach(v=>ajouterVaccin(v.nom,v.date,v.lien));
donn√©es.maladies.forEach(m=>ajouterMaladie(m.nom,m.date,m.remarque));
donn√©es.accidents.forEach(a=>ajouterAccident(a.type,a.date,a.suite));
donn√©es.traitements.forEach(t=>ajouterTraitement(t.nom,t.debut,t.fin,t.posologie));
donn√©es.pdfs.forEach(p=>listePDF.innerHTML+=`<li>${p}</li>`);
donn√©es.liens.forEach(l=>ajouterLien(l.nom,l.url));
};
</script>

</body>
</html>